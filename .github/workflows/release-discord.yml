name: Discord Notifications

on:
  push:
  release:
    types: [published]

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Notify Discord
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
          DISCORD_MESSAGE: |
            ${{ github.event_name == 'push' && format(
            'ğŸ” **Nuevo Push Detectado**\n\nğŸ‘¤ Autor: **{0}**\nğŸ“¦ Repo: **{1}**\nğŸŒ¿ Branch: **{2}**\nğŸ” Commit: `{3}`\nğŸ”— https://github.com/{1}/commit/{3}',
            github.actor,
            github.repository,
            github.ref_name,
            github.sha
            ) || '' }}

            ${{ github.event_name == 'release' && format(
            'ğŸ†• **Nueva Build Disponible**\n\nğŸ“¦ Proyecto: **{0}**\nğŸ·ï¸ VersiÃ³n: **{1}**\nğŸ‘¤ Publicado por: **{2}**\n\nğŸ“ Cambios:\n{3}\n\nâ¬‡ï¸ Descargar:\n{4}',
            github.repository,
            github.event.release.tag_name,
            github.actor,
            github.event.release.body,
            github.event.release.html_url
            ) || '' }}
